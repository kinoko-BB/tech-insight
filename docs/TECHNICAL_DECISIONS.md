# TechInsight æŠ€è¡“çš„æ±ºå®šäº‹é …

## æ¦‚è¦

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€TechInsightã®é–‹ç™ºã«ãŠã„ã¦è¡Œã£ãŸé‡è¦ãªæŠ€è¡“çš„æ±ºå®šã¨ãã®ç†ç”±ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚
æ¡ç‚¹è€…ãƒ»ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ãŒè¨­è¨ˆæ„å›³ã‚’ç†è§£ã—ã‚„ã™ã„ã‚ˆã†ã€å„æ±ºå®šã®èƒŒæ™¯ã¨ä»£æ›¿æ¡ˆã¨ã®æ¯”è¼ƒã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚

---

## 1. Embeddingãƒ¢ãƒ‡ãƒ«: sentence-transformers

### é¸æŠ: sentence-transformers + multilingual-e5-small

### æ±ºå®šç†ç”±

1. **APIã‚­ãƒ¼ä¸è¦ã§ãƒ­ãƒ¼ã‚«ãƒ«å®Ÿè¡Œå¯èƒ½**
   - è©•ä¾¡è€…ã®ç’°å¢ƒå†ç¾è¦ä»¶ã‚’æº€ãŸã™
   - å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ä¾å­˜ãªã—
   - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ç’°å¢ƒã§ã‚‚å‹•ä½œ

2. **æ—¥æœ¬èªå¯¾å¿œã®è»½é‡ãƒ¢ãƒ‡ãƒ«**
   - multilingual-e5-smallã¯å¤šè¨€èªå¯¾å¿œï¼ˆ384æ¬¡å…ƒï¼‰
   - e5-baseã¨æ¯”è¼ƒã—ã¦æ¤œç´¢å“è³ªã®å·®ã¯å®Ÿç”¨ä¸Šå•é¡Œãªã„ãƒ¬ãƒ™ãƒ«
   - CPUç’°å¢ƒã§ã®åˆæœŸãƒ‡ãƒ¼ã‚¿1000ä»¶ã®Embeddingç”ŸæˆãŒç¾å®Ÿçš„ãªæ™‚é–“ã§å®Œäº†
   - Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚µã‚¤ã‚ºã‚‚ç´„500MBã«æŠ‘åˆ¶

3. **Pythonç’°å¢ƒã§ã®ç›´æ¥å‹•ä½œ**
   - FastAPIã¨åŒä¸€ãƒ—ãƒ­ã‚»ã‚¹ã§å®Ÿè¡Œå¯èƒ½
   - è¿½åŠ ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆåˆ¥ã‚³ãƒ³ãƒ†ãƒŠç­‰ï¼‰ä¸è¦
   - ãƒ‡ãƒ—ãƒ­ã‚¤æ§‹æˆãŒã‚·ãƒ³ãƒ—ãƒ«

### ä»£æ›¿æ¡ˆã¨ã®æ¯”è¼ƒ

| é¸æŠè‚¢ | ãƒ¡ãƒªãƒƒãƒˆ | ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ | åˆ¤å®š |
|--------|---------|-----------|------|
| **sentence-transformers (e5-small)** | APIã‚­ãƒ¼ä¸è¦ã€è»½é‡ã€CPUå®Ÿç”¨çš„ | ç²¾åº¦ã¯e5-baseã‚ˆã‚Šã‚„ã‚„åŠ£ã‚‹ | âœ… æ¡ç”¨ |
| sentence-transformers (e5-base) | é«˜ç²¾åº¦ | CPUç’°å¢ƒã§1000ä»¶å‡¦ç†ã«æ•°ååˆ† | âŒ èµ·å‹•æ™‚é–“ |
| OpenAI Embeddings | é«˜ç²¾åº¦ã€é«˜é€Ÿ | APIã‚­ãƒ¼å¿…é ˆ | âŒ è¦ä»¶ä¸é©åˆ |
| Ollama + nomic-embed | GPUæ´»ç”¨å¯èƒ½ | Dockeræ§‹æˆè¤‡é›‘åŒ– | âŒ éå‰° |
| Cohere Embeddings | å¤šè¨€èªå¯¾å¿œ | APIã‚­ãƒ¼å¿…é ˆ | âŒ è¦ä»¶ä¸é©åˆ |

### å®Ÿè£…ä¸Šã®å·¥å¤«

```python
# ãƒãƒƒãƒå‡¦ç†ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºä¿
def generate_embeddings_batch(texts: list[str], batch_size: int = 32):
    """ãƒãƒƒãƒå‡¦ç†ã§Embeddingç”Ÿæˆï¼ˆãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–ï¼‰"""
    embeddings = []
    for i in range(0, len(texts), batch_size):
        batch = texts[i:i + batch_size]
        batch_embeddings = model.encode(batch)
        embeddings.extend(batch_embeddings)
    return embeddings
```

---

## 2. ãƒ™ã‚¯ãƒˆãƒ«DB: pgvector

### é¸æŠ: PostgreSQL + pgvectoræ‹¡å¼µ

### æ±ºå®šç†ç”±

1. **è¿½åŠ ã‚µãƒ¼ãƒ“ã‚¹ä¸è¦**
   - PostgreSQLæ‹¡å¼µã¨ã—ã¦å‹•ä½œ
   - åˆ¥é€”ãƒ™ã‚¯ãƒˆãƒ«DBã‚’ç«‹ã¦ã‚‹å¿…è¦ãªã—
   - Docker Composeæ§‹æˆãŒã‚·ãƒ³ãƒ—ãƒ«

2. **1ä¸‡ä»¶è¦æ¨¡ã«ååˆ†ãªæ€§èƒ½**
   - HNSWã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§é«˜é€Ÿæ¤œç´¢
   - æœ¬ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¦æ¨¡ã§ã¯éå‰°æ€§èƒ½

3. **SQLAlchemyã¨ã®çµ±åˆãŒå®¹æ˜“**
   - æ—¢å­˜ã®ORMãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã¿å¯èƒ½
   - é€šå¸¸ã®SQLã‚¯ã‚¨ãƒªã¨çµ„ã¿åˆã‚ã›å¯èƒ½

### ä»£æ›¿æ¡ˆã¨ã®æ¯”è¼ƒ

| é¸æŠè‚¢ | é©æ­£è¦æ¨¡ | ãƒ¡ãƒªãƒƒãƒˆ | ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ | åˆ¤å®š |
|--------|---------|---------|-----------|------|
| **pgvector** | ~100ä¸‡ä»¶ | è¿½åŠ ã‚µãƒ¼ãƒ“ã‚¹ä¸è¦ | è¶…å¤§è¦æ¨¡ã«ã¯ä¸å‘ã | âœ… æ¡ç”¨ |
| Qdrant | 100ä¸‡~æ•°å„„ä»¶ | é«˜æ€§èƒ½ã€è±Šå¯Œãªæ©Ÿèƒ½ | åˆ¥ã‚µãƒ¼ãƒ“ã‚¹å¿…è¦ | âŒ éå‰° |
| Milvus | æ•°å„„ä»¶~ | ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå‘ã‘ | æ§‹æˆãŒè¤‡é›‘ | âŒ éå‰° |
| Pinecone | ä»»æ„ | ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ | APIã‚­ãƒ¼å¿…é ˆ | âŒ è¦ä»¶ä¸é©åˆ |

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆã®æ ¹æ‹ 

```sql
CREATE INDEX idx_articles_embedding_hnsw ON articles
USING hnsw (embedding vector_cosine_ops)
WITH (m = 16, ef_construction = 128);
```

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | ç†ç”± |
|-----------|---|------|
| m | 16 | 1000ä»¶è¦æ¨¡ã§ã¯ååˆ†ã€‚æ¤œç´¢ç²¾åº¦ã¨é€Ÿåº¦ã®ãƒãƒ©ãƒ³ã‚¹ |
| ef_construction | 128 | ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ§‹ç¯‰ç²¾åº¦ã€‚é«˜ã‚ã«è¨­å®šã—å“è³ªç¢ºä¿ |
| vector_cosine_ops | - | ã‚³ã‚µã‚¤ãƒ³é¡ä¼¼åº¦ã€‚ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢ã«æœ€é© |

---

## 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: Tailwind CSS

### é¸æŠ: Tailwind CSS 3.x

### æ±ºå®šç†ç”±

1. **Next.js 14ã¨ã®ç›¸æ€§**
   - å…¬å¼ã‚µãƒãƒ¼ãƒˆã€è¨­å®šãŒå®¹æ˜“
   - App Routerã¨ã®çµ±åˆå®Ÿç¸¾è±Šå¯Œ

2. **ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã§é«˜é€Ÿé–‹ç™º**
   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã§ã‚¹ã‚¿ã‚¤ãƒ«å®Œçµ
   - CSSãƒ•ã‚¡ã‚¤ãƒ«é–“ã®ä¾å­˜é–¢ä¿‚ãªã—
   - ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã®ä¸€è²«æ€§ç¶­æŒãŒå®¹æ˜“

3. **ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºæœ€é©åŒ–**
   - PurgeCSSã«ã‚ˆã‚‹æœªä½¿ç”¨ã‚¹ã‚¿ã‚¤ãƒ«å‰Šé™¤
   - æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã§æœ€å°é™ã®CSSã®ã¿å‡ºåŠ›

### ä»£æ›¿æ¡ˆã¨ã®æ¯”è¼ƒ

| é¸æŠè‚¢ | ãƒ¡ãƒªãƒƒãƒˆ | ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ | åˆ¤å®š |
|--------|---------|-----------|------|
| **Tailwind CSS** | é«˜é€Ÿé–‹ç™ºã€å°ãƒãƒ³ãƒ‰ãƒ« | å­¦ç¿’ã‚³ã‚¹ãƒˆ | âœ… æ¡ç”¨ |
| CSS Modules | ã‚¹ã‚³ãƒ¼ãƒ—å®‰å…¨ | ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ•£ | âŒ é–‹ç™ºåŠ¹ç‡ |
| styled-components | CSS-in-JS | ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºå¢— | âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ |
| shadcn/ui | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæä¾› | Tailwindå‰æ | ğŸ”„ ä½µç”¨æ¤œè¨ |

---

## 4. æ¤œç´¢æˆ¦ç•¥: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢

### é¸æŠ: ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã®åˆ‡æ›¿æ–¹å¼

### è¨­è¨ˆæ–¹é‡

1. **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ**
   - æ„å‘³çš„ãªé¡ä¼¼æ€§ã§é–¢é€£è¨˜äº‹ã‚’ç™ºè¦‹
   - ã€ŒReactã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€â†’ useMemo, useCallbacké–¢é€£è¨˜äº‹ã‚‚ãƒ’ãƒƒãƒˆ

2. **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã‚‚æä¾›**
   - ç‰¹å®šã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¤œç´¢ãªã©ã€å®Œå…¨ä¸€è‡´ãŒå¿…è¦ãªã‚±ãƒ¼ã‚¹
   - pg_trgmã«ã‚ˆã‚‹é¡ä¼¼æ–‡å­—åˆ—æ¤œç´¢

3. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ‡æ›¿å¯èƒ½**
   - UIã§æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠå¯èƒ½
   - ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¿œã˜ãŸä½¿ã„åˆ†ã‘

### å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

```python
async def search(query: str, mode: SearchMode) -> list[Article]:
    match mode:
        case SearchMode.SEMANTIC:
            return await semantic_search(query)
        case SearchMode.KEYWORD:
            return await keyword_search(query)
```

---

## 5. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­è¨ˆ

### 1000ä»¶å¯¾å¿œã®è¨­è¨ˆãƒã‚¤ãƒ³ãƒˆ

| è¦³ç‚¹ | å¯¾ç­– | åŠ¹æœ |
|------|------|------|
| ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ | HNSWã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ | O(log n)ã®æ¤œç´¢æ™‚é–“ |
| ä¸€è¦§å–å¾— | ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å¿…é ˆ | ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡åˆ¶é™ |
| Embeddingç”Ÿæˆ | ãƒãƒƒãƒå‡¦ç† | ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆå‘ä¸Š |
| DBæ¥ç¶š | ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ¼ãƒ« | æ¥ç¶šã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸› |

### ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£è¦³ç‚¹

```
ç¾åœ¨ã®è¨­è¨ˆï¼ˆ1000ä»¶ = åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼‰
    â†“ è¨˜äº‹æ•°å¢—åŠ 
Phase 2å¯¾å¿œï¼ˆ~10ä¸‡ä»¶ï¼‰
  - HNSWãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ï¼ˆm=32, ef_construction=256ï¼‰
  - Redis ã‚­ãƒ£ãƒƒã‚·ãƒ¥å°å…¥
    â†“ ã•ã‚‰ã«å¢—åŠ 
Phase 3å¯¾å¿œï¼ˆ10ä¸‡ä»¶è¶…ï¼‰
  - å°‚ç”¨ãƒ™ã‚¯ãƒˆãƒ«DBï¼ˆQdrantç­‰ï¼‰ã¸ã®ç§»è¡Œ
  - æ¤œç´¢ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ†é›¢
```

---

## 6. ãƒãƒ¼ãƒ é–‹ç™ºå¯¾å¿œ

### å‹å®šç¾©ã®å¾¹åº•

**TypeScriptï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰:**
```typescript
// æ˜ç¢ºãªå‹å®šç¾©ã§ãƒãƒ¼ãƒ é–“ã®èªè­˜é½Ÿé½¬ã‚’é˜²æ­¢
interface Article {
  id: number;
  title: string;
  content: string;
  author?: string;
  category?: string;  // Frontend, Backend, DevOps, AI/ML
  publishedAt?: string;
  createdAt: string;
}
```

**Pydanticï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼‰:**
```python
# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨å‹å®‰å…¨æ€§ã‚’åŒæ™‚ã«ç¢ºä¿
class ArticleCreate(BaseModel):
    title: str = Field(..., max_length=255)
    content: str
    author: str | None = None
    category: str | None = None
```

### OpenAPIè‡ªå‹•ç”Ÿæˆ

- FastAPIã®å‹ãƒ’ãƒ³ãƒˆã‹ã‚‰OpenAPIä»•æ§˜ã‚’è‡ªå‹•ç”Ÿæˆ
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯OpenAPIä»•æ§˜ã‹ã‚‰å‹ã‚’ç”Ÿæˆå¯èƒ½
- APIä»•æ§˜ã®ä¿¡é ¼ã§ãã‚‹å˜ä¸€ã‚½ãƒ¼ã‚¹ï¼ˆSingle Source of Truthï¼‰

### ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ†é›¢

```
routers/     # HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ï¼ˆå…¥å‡ºåŠ›å¤‰æ›ï¼‰
    â†“
services/    # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ†ã‚¹ãƒˆå®¹æ˜“ï¼‰
    â†“
models/      # ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆæ°¸ç¶šåŒ–ï¼‰
```

**åˆ©ç‚¹:**
- å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è²¬å‹™ãŒæ˜ç¢º
- å˜ä½“ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ã„
- ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼é–“ã§ã®åˆ†æ¥­ãŒå®¹æ˜“

---

## 7. ä¿å®ˆé‹ç”¨è¦³ç‚¹

### ãƒ­ã‚°è¨­è¨ˆ

```python
# æ§‹é€ åŒ–ãƒ­ã‚°ã§æ¤œç´¢ãƒ»åˆ†æãŒå®¹æ˜“
logger.info(
    "search_executed",
    query=query,
    mode=mode,
    result_count=len(results),
    duration_ms=duration
)
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```python
# ä¸€è²«ã—ãŸã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼
class AppException(Exception):
    def __init__(self, code: str, message: str, status: int = 400):
        self.code = code
        self.message = message
        self.status = status
```

### ç’°å¢ƒè¨­å®š

```python
# ç’°å¢ƒå¤‰æ•°ã§ã®è¨­å®šç®¡ç†ï¼ˆ12 Factor Appæº–æ‹ ï¼‰
class Settings(BaseSettings):
    database_url: str
    embedding_model: str = "intfloat/multilingual-e5-small"

    class Config:
        env_file = ".env"
```

---

## 8. UI/UXè¦³ç‚¹

### æ¤œç´¢ä½“é¨“ã®è¨­è¨ˆ

1. **å³åº§ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**
   - æ¤œç´¢ä¸­ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
   - æ¤œç´¢çµæœã®ã‚¹ã‚³ã‚¢è¡¨ç¤º

2. **æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ã®å¯è¦–åŒ–**
   - ç¾åœ¨ã®æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ã‚’æ˜ç¤º
   - ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿UIã®ç›´æ„Ÿçš„ãªé…ç½®

3. **çµæœã®å¯èª­æ€§**
   - è¦ç´„æ–‡ã®è¡¨ç¤º
   - ãƒã‚¤ãƒ©ã‚¤ãƒˆè¡¨ç¤ºï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢æ™‚ï¼‰

### ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

- ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®ãƒ‡ã‚¶ã‚¤ãƒ³
- Tailwindã®ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆæ´»ç”¨

---

## 9. ãƒ‡ãƒ¼ã‚¿è¨­è¨ˆ

### åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆarticles.csvï¼‰

| é …ç›® | å€¤ |
|------|---|
| è¨˜äº‹æ•° | 1000ä»¶ |
| ã‚«ãƒ©ãƒ  | id, title, content, author, category, published_at |
| ã‚«ãƒ†ã‚´ãƒª | Frontend, Backend, DevOps, AI/MLï¼ˆå„250ä»¶ç¨‹åº¦ï¼‰ |
| è¨€èª | è‹±èª |

### ã‚«ãƒ†ã‚´ãƒª vs ã‚¿ã‚°ã®é¸æŠ

**é¸æŠ: ã‚«ãƒ†ã‚´ãƒªï¼ˆå˜ä¸€å€¤ï¼‰**

åˆæœŸãƒ‡ãƒ¼ã‚¿ãŒã‚«ãƒ†ã‚´ãƒªãƒ™ãƒ¼ã‚¹ã®æ§‹é€ ã®ãŸã‚ã€ã‚·ãƒ³ãƒ—ãƒ«ãªã‚«ãƒ†ã‚´ãƒªã‚«ãƒ©ãƒ ã‚’æ¡ç”¨ã€‚
å°†æ¥çš„ã«ã‚¿ã‚°ã®å¤šå¯¾å¤šé–¢ä¿‚ãŒå¿…è¦ã«ãªã£ãŸå ´åˆã¯ã€åˆ¥é€”tags/article_tagsãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ å¯èƒ½ã€‚

---

## 10. è¨˜äº‹æ›´æ–°æ™‚ã®Embeddingå†ç”Ÿæˆ

### æ–¹é‡

è¨˜äº‹ã®`title`ã¾ãŸã¯`content`ãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã€Embeddingãƒ™ã‚¯ãƒˆãƒ«ã‚’å†ç”Ÿæˆã™ã‚‹ã€‚
ã“ã‚Œã«ã‚ˆã‚Šã€ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ã®çµæœãŒå¸¸ã«æœ€æ–°ã®è¨˜äº‹å†…å®¹ã¨ä¸€è‡´ã™ã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ã€‚

### å®Ÿè£…ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

```python
async def update_article(article_id: int, data: ArticleUpdate) -> Article:
    article = await get_article(article_id)

    # title ã¾ãŸã¯ content ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€Embeddingã‚’å†ç”Ÿæˆ
    content_changed = (
        (data.title is not None and data.title != article.title) or
        (data.content is not None and data.content != article.content)
    )

    updated = await update_article_in_db(article_id, data)

    if content_changed:
        embedding = generate_embedding(f"{updated.title} {updated.content}")
        await update_article_embedding(article_id, embedding)

    return updated
```

### è¨­è¨ˆåˆ¤æ–­

- **åŒæœŸå®Ÿè¡Œ:** 1ä»¶ã®è¨˜äº‹æ›´æ–°ã«å¯¾ã™ã‚‹Embeddingç”Ÿæˆã¯æ•°ç™¾msç¨‹åº¦ã®ãŸã‚ã€éåŒæœŸã‚­ãƒ¥ãƒ¼ã¯ä¸è¦
- **å†ç”Ÿæˆãƒˆãƒªã‚¬ãƒ¼:** `title`ã¨`content`ã®å¤‰æ›´æ™‚ã®ã¿ï¼ˆ`author`ã‚„`category`ã®å¤‰æ›´ã§ã¯å†ç”Ÿæˆã—ãªã„ï¼‰
- **å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼:** `"query: {title} {content}"` ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§e5ãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã™

---

## ã¾ã¨ã‚

| è¦³ç‚¹ | æ±ºå®šäº‹é … | ä¸»ãªç†ç”± |
|------|---------|---------|
| Embedding | sentence-transformers (e5-small) | APIã‚­ãƒ¼ä¸è¦ã€è»½é‡ã€CPUå®Ÿç”¨çš„ |
| ãƒ™ã‚¯ãƒˆãƒ«DB | pgvector | è¿½åŠ ã‚µãƒ¼ãƒ“ã‚¹ä¸è¦ã€ååˆ†ãªæ€§èƒ½ |
| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | Tailwind CSS | é«˜é€Ÿé–‹ç™ºã€Next.jsè¦ªå’Œæ€§ |
| æ¤œç´¢ | ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ | ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å¯¾å¿œã®æŸ”è»Ÿæ€§ |
| å‹å®‰å…¨ | TypeScript + Pydantic | ãƒãƒ¼ãƒ é–‹ç™ºã®å“è³ªç¢ºä¿ |
| ãƒ‡ãƒ¼ã‚¿æ§‹é€  | ã‚«ãƒ†ã‚´ãƒªï¼ˆå˜ä¸€å€¤ï¼‰ | åˆæœŸãƒ‡ãƒ¼ã‚¿ã«åˆã‚ã›ãŸã‚·ãƒ³ãƒ—ãƒ«è¨­è¨ˆ |
